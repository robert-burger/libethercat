<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libethercat - an embeddable realtime EtherCAT-master library: libethercat</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libethercat - an embeddable realtime EtherCAT-master library
   </div>
   <div id="projectbrief">Communicate with EtherCAT slaves attached to a Network interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">libethercat </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> EtherCAT-master library <br  />
</p>
<p>This library provides all functionality to communicate with EtherCAT slaves attached to a Network interface.</p>
<ul>
<li>support for a queue with mailbox init command for every slave</li>
<li>distributed clock support</li>
<li>mailbox support CoE, SoE, FoE,</li>
<li>scan EtherCAT bus in INIT-to-INIT state transition, thus switching to INIT in every case will do a bus re-scan.</li>
<li>switching to PREOP state will enable full mailbox support if it is supported by the corresponding EtherCAT slave.</li>
<li>a PREOP-to-SAFEOP prepares all slaves configured in a process data group<ul>
<li>sending init command</li>
<li>calculate cyclic process data sizes</li>
<li>create sync manager configuration</li>
<li>create fmmu configuration</li>
<li>configure slave's for distributed clocks</li>
<li>cyclically provide meassurement of process data</li>
</ul>
</li>
<li>a SAFEOP-to-OP transition additionally sends command to the attached slaves in every group cycle.</li>
<li>efficient frame scheduling: EtherCAT datagrams are only queued in state SAFEOP and OP. They will be put in one ore many Ethernet frames and sent all cyclically with one call to <a class="el" href="group__hardware__group.html#ga317d72c3f8cb8460308f42eec6381383" title="start sending queued ethercat datagrams">hw_tx()</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
Network device access</h1>
<ul>
<li><b>raw socket</b> » The most common way sending ethernet frames in Linux is opening a raw network socket (<code>SOCK_RAW</code>). Therefor the program must either be run as root or with the capability flag <code>CAP_NET_RAW</code>. Either do sth like: <code>sudo setcap cap_net_raw=ep .libs/example_with_dc</code> or checkout grant_cap_net_raw kernel module from Flo Schmidt (<a href="https://gitlab.com/fastflo/open_ethercat">https://gitlab.com/fastflo/open_ethercat</a>).</li>
<li><b>raw_socket_mmaped</b> » Like above but don't use read/write to provide frame buffers to kernel and use mmaped buffers directly from kernel.</li>
<li><b>file</b> » Most performant/determinstic interface to send/receive frames with network hardware. Requires hacked linux network driver. Can also be used without interrupts to avoid context switches. For how to compile and use such a driver head over to drivers readme.</li>
<li><b>pikeos</b> » Special pikeos hardware access.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Legal notices</h1>
<p>This software was developed and made available to the public by the <a href="https://www.dlr.de/rm">Institute of Robotics and Mechatronics of the German Aerospace Center (DLR)</a>.</p>
<p>Please note that the use of the EtherCAT technology, the EtherCAT brand name and the EtherCAT logo is only permitted if the property rights of Beckhoff Automation GmbH are observed. For further information please contact Beckhoff Automation GmbH &amp; Co. KG, Hülshorstweg 20, D-33415 Verl, Germany (www.beckhoff.com) or the EtherCAT Technology Group, Ostendstraße 196, D-90482 Nuremberg, Germany (ETG, www.ethercat.org).</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Usage</h2>
<p>See INTRODUCTION.md or <a href="https://robert-burger.github.io/libethercat/">gh-pages</a> for reference.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Build from source</h2>
<p><code>libethercat</code> uses autotools as build system.</p>
<h3><a class="anchor" id="autotoc_md5"></a>
Prerequisites</h3>
<p>Ensure that <code>libosal</code> is installed in your system. You can get <code>libosal</code> from here <a href="https://github.com/robert-burger/libosal.git">https://github.com/robert-burger/libosal.git</a> . To build <code>libethercat</code> from source execute something like:</p>
<div class="fragment"><div class="line">git clone https://github.com/robert-burger/libethercat.git</div>
<div class="line">cd libethercat</div>
<div class="line">./bootstrap.sh</div>
<div class="line">autoreconf -is</div>
<div class="line">./configure</div>
<div class="line">make</div>
<div class="line">sudo make install</div>
</div><!-- fragment --><p>This will build and install a static as well as a dynamic library. For use in other project you can use the generated pkg-config file to retreave cflags and linker flags.</p>
<h3><a class="anchor" id="autotoc_md6"></a>
CMake</h3>
<p>Steps to build: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line"># Please change the path to the install dir. If you chose a global install you can omit the CMAKE_PREFIX_PATH option</div>
<div class="line"># You can specify which EtherCAT devices should be included into the build with -DECAT_DEVICE=&quot;sock_raw+sock_raw_mmaped+...&quot;</div>
<div class="line">cmake -DCMAKE_PREFIX_PATH=&lt;installdir of libosal&gt; -DECAT_DEVICE=&quot;sock_raw+sock_raw_mmaped&quot; ..</div>
<div class="line">cmake --build . </div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md7"></a>
Configuration parameters</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CMAKE_PREFIX_PATH   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Install directory of the libosal    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ECAT_DEVICE   </td><td class="markdownTableBodyNone">sock_raw   </td><td class="markdownTableBodyNone">List of EtherCAT devices as <code>+</code> separated list. Possible values: sock_raw+sock_raw_mmaped+file+pikeos+bpf    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BUILD_SHARED_LIBS   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">Flag to build shared libraries instead of static ones.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">MBX_SUPPORT_COE   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">Flag to enable or disable Mailbox CoE support    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">MBX_SUPPORT_FOE   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">Flag to enable or disable Mailbox FoE support    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">MBX_SUPPORT_SOE   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">Flag to enable or disable Mailbox SoE support    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">MBX_SUPPORT_EOE   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">Flag to enable or disable Mailbox EoE support   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md8"></a>
Tools</h2>
<p>libethercat also provides some small helper programs for the EtherCAT bus.</p>
<h3><a class="anchor" id="autotoc_md9"></a>
eepromtool</h3>
<p>With eepromtool you can read and write EtherCAT slave's eeprom.</p>
<h4><a class="anchor" id="autotoc_md10"></a>
read eeprom</h4>
<p>To do a read operation simply run: </p><pre class="fragment">eepromtool -i eth1 -s 0 -r -f eeprom.bin
</pre><p> If no filename if specified, eepromtool will print the contents to stdout, which you can pipe to hexdump for example. </p><pre class="fragment">eepromtool -i eth1 -s 0 -r | hexdump -v -C | less -S
</pre> <h4><a class="anchor" id="autotoc_md11"></a>
write</h4>
<p>To do a write operation simply run: </p><pre class="fragment">eepromtool -i eth1 -s 0 -w -f eeprom.bin
</pre><p> If no filename if specified, eepromtool will read from stdin. </p><pre class="fragment">cat eeprom.bin | eepromtool -i eth1 -s 0 -w
</pre> <h4><a class="anchor" id="autotoc_md12"></a>
example_with_dc</h4>
<p>This is a more complex example on how to use libethercat in realtime/control systems.</p>
<p>It tries to do the following:</p>
<ul>
<li>Scan the EtherCAT network.</li>
<li>Try to do a default configuration of the found slaves</li>
<li>Configures distributed clocks of all slaves (if supported)</li>
<li>Create a periodic realtime task which does cyclic data (process data) exchange.</li>
<li>Do some jitter logging. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
